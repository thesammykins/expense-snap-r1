<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Snap - QR Code Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/qr-code-styling@1.6.0-rc.1/lib/qr-code-styling.js"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-green-50 to-blue-50">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-5xl font-bold text-gray-800 mb-2">üí∞ Expense Snap</h1>
            <p class="text-xl text-gray-600 mb-4">QR Code Generator for R1 Device</p>
            <p class="text-sm text-gray-500">Production-ready expense tracking with AI-powered insights</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Info Section -->
            <div class="bg-white rounded-lg shadow-xl p-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">üì± Installation</h2>

                <div class="space-y-4 mb-8">
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">1</div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Generate QR Code</h3>
                            <p class="text-sm text-gray-600">Click the button below to create your QR code</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">2</div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Scan with R1</h3>
                            <p class="text-sm text-gray-600">Open your Rabbit R1 device and scan the QR code</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold">3</div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Start Tracking</h3>
                            <p class="text-sm text-gray-600">Begin logging expenses with camera scanning!</p>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <h3 class="font-semibold text-green-800 mb-2">‚ú® Features</h3>
                    <ul class="space-y-1 text-sm text-green-700">
                        <li>üì∑ Camera receipt scanning with LLM OCR</li>
                        <li>üìä Smart insights with AI-powered tips</li>
                        <li>üìã Expense history with virtual scrolling</li>
                        <li>üí∞ Budget tracking with visual indicators</li>
                        <li>üîÑ Rabbithole journal sync (optional)</li>
                        <li>üéÆ Hardware-optimized navigation</li>
                    </ul>
                </div>

                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-gray-800 mb-2">üîó App Details</h3>
                    <div class="space-y-2 text-sm">
                        <div>
                            <span class="font-medium text-gray-600">URL:</span>
                            <p class="text-gray-800 break-all font-mono text-xs">https://thesammykins.github.io/expense-snap-r1/</p>
                        </div>
                        <div>
                            <span class="font-medium text-gray-600">Version:</span>
                            <span class="text-gray-800">1.0.0</span>
                        </div>
                        <div>
                            <span class="font-medium text-gray-600">Size:</span>
                            <span class="text-gray-800">156KB</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- QR Code Display Section -->
            <div class="bg-white rounded-lg shadow-xl p-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">QR Code</h2>

                <div id="qrCodeContainer" class="flex flex-col items-center">
                    <div id="qrCode" class="mb-4"></div>
                    <div id="qrPlaceholder" class="w-80 h-80 border-4 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-500">
                        <div class="text-center">
                            <svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            <p class="text-lg font-medium">Click below to generate</p>
                        </div>
                    </div>
                </div>

                <button id="generateBtn"
                        class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition duration-200 text-lg mt-6">
                    üé® Generate QR Code
                </button>

                <div id="downloadSection" class="mt-6 hidden space-y-3">
                    <button id="downloadBtn"
                            class="w-full bg-gray-800 hover:bg-gray-900 text-white font-semibold py-3 px-4 rounded-lg transition duration-200">
                        üíæ Download QR Code
                    </button>

                    <button id="printBtn"
                            class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg transition duration-200">
                        üñ®Ô∏è Print QR Code
                    </button>
                </div>

                <div class="mt-6 pt-6 border-t border-gray-200">
                    <p class="text-xs text-gray-500 text-center">
                        Scan this QR code with your Rabbit R1 device to install Expense Snap
                    </p>
                </div>
            </div>
        </div>

        <footer class="text-center mt-12 text-gray-500 text-sm">
            <p>Built with ‚ù§Ô∏è for Rabbit R1 |
                <a href="https://github.com/thesammykins/expense-snap-r1" class="text-green-600 hover:text-green-700 underline" target="_blank">
                    View on GitHub
                </a>
            </p>
        </footer>
    </div>

    <script>
        // Expense Snap QR Code Generator
        class ExpenseSnapQRGenerator {
            constructor() {
                this.currentQRCode = null;
                this.appData = {
                    title: "Expense Snap",
                    url: "https://thesammykins.github.io/expense-snap-r1/",
                    description: "Track expenses with camera scanning and AI insights",
                    iconUrl: "",
                    themeColor: "#00ff00"
                };
                this.init();
            }

            init() {
                this.bindEvents();
            }

            bindEvents() {
                document.getElementById('generateBtn').addEventListener('click', () => {
                    this.generateQRCode();
                });

                document.getElementById('downloadBtn').addEventListener('click', () => {
                    this.downloadQRCode();
                });

                document.getElementById('printBtn').addEventListener('click', () => {
                    this.printQRCode();
                });
            }

            async generateQRCode() {
                try {
                    // Show loading
                    const generateBtn = document.getElementById('generateBtn');
                    generateBtn.disabled = true;
                    generateBtn.textContent = '‚è≥ Generating...';

                    // Clear existing QR code
                    const qrCodeContainer = document.getElementById('qrCode');
                    qrCodeContainer.innerHTML = '';

                    // Hide placeholder
                    document.getElementById('qrPlaceholder').style.display = 'none';

                    // Create JSON string for QR code
                    const qrData = JSON.stringify(this.appData);

                    // Configure QR code
                    const qrCodeOptions = {
                        width: 320,
                        height: 320,
                        type: "canvas",
                        data: qrData,
                        margin: 10,
                        qrOptions: {
                            typeNumber: 0,
                            mode: "Byte",
                            errorCorrectionLevel: "M"
                        },
                        dotsOptions: {
                            color: "#000000",
                            type: "rounded"
                        },
                        backgroundOptions: {
                            color: "#ffffff"
                        },
                        cornersSquareOptions: {
                            color: "#00ff00",
                            type: "extra-rounded"
                        },
                        cornersDotOptions: {
                            color: "#00ff00",
                            type: "dot"
                        }
                    };

                    // Create QR code instance
                    this.currentQRCode = new QRCodeStyling(qrCodeOptions);

                    // Create wrapper
                    const wrapper = document.createElement('div');
                    wrapper.className = 'qr-code-wrapper';
                    wrapper.style.cssText = `
                        animation: fadeIn 0.5s ease-in;
                        padding: 20px;
                        background: white;
                        border-radius: 12px;
                        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                    `;

                    // Append QR code
                    this.currentQRCode.append(wrapper);
                    qrCodeContainer.appendChild(wrapper);

                    // Show download section
                    document.getElementById('downloadSection').classList.remove('hidden');

                    // Update button
                    generateBtn.textContent = '‚úÖ Generated!';
                    generateBtn.classList.replace('bg-green-500', 'bg-green-600');

                    setTimeout(() => {
                        generateBtn.textContent = 'üîÑ Regenerate';
                        generateBtn.disabled = false;
                    }, 2000);

                    this.showNotification('QR Code generated successfully! Scan with your R1 device.', 'success');

                } catch (error) {
                    console.error('Error generating QR code:', error);
                    this.showNotification('Error generating QR code. Please try again.', 'error');

                    document.getElementById('qrPlaceholder').style.display = 'flex';
                    const generateBtn = document.getElementById('generateBtn');
                    generateBtn.disabled = false;
                    generateBtn.textContent = 'üé® Generate QR Code';
                }
            }

            downloadQRCode() {
                if (!this.currentQRCode) {
                    this.showNotification('Please generate a QR code first', 'warning');
                    return;
                }

                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    const size = 500;
                    const padding = 40;
                    canvas.width = size + (padding * 2);
                    canvas.height = size + (padding * 2) + 60;

                    // White background
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // Green border
                    ctx.strokeStyle = '#00ff00';
                    ctx.lineWidth = 6;
                    ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 70);

                    // Get QR code canvas
                    const qrCanvas = document.querySelector('#qrCode canvas');
                    if (qrCanvas) {
                        ctx.drawImage(qrCanvas, padding, padding, size, size);
                    }

                    // Add title
                    ctx.fillStyle = '#000000';
                    ctx.font = 'bold 24px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('Expense Snap - R1 Creation', canvas.width / 2, canvas.height - 30);

                    // Download
                    const link = document.createElement('a');
                    link.download = 'expense-snap-qr-code.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();

                    this.showNotification('QR Code downloaded!', 'success');

                } catch (error) {
                    console.error('Error downloading:', error);
                    this.currentQRCode.download({
                        name: "expense-snap-qr-code",
                        extension: "png"
                    });
                }
            }

            printQRCode() {
                if (!this.currentQRCode) {
                    this.showNotification('Please generate a QR code first', 'warning');
                    return;
                }

                const printWindow = window.open('', '_blank');
                const qrCanvas = document.querySelector('#qrCode canvas');

                printWindow.document.write(`
                    <html>
                    <head>
                        <title>Expense Snap - QR Code</title>
                        <style>
                            body {
                                margin: 0;
                                padding: 40px;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                font-family: Arial, sans-serif;
                            }
                            .qr-container {
                                border: 4px solid #00ff00;
                                padding: 30px;
                                background: white;
                            }
                            h1 {
                                margin-top: 20px;
                                font-size: 28px;
                            }
                            p {
                                color: #666;
                                margin: 10px 0;
                            }
                            .url {
                                font-family: monospace;
                                background: #f0f0f0;
                                padding: 10px;
                                border-radius: 4px;
                                margin: 20px 0;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="qr-container">
                            <img src="${qrCanvas.toDataURL()}" alt="Expense Snap QR Code" />
                        </div>
                        <h1>üí∞ Expense Snap</h1>
                        <p>Scan with your Rabbit R1 device to install</p>
                        <div class="url">${this.appData.url}</div>
                        <p style="margin-top: 40px; color: #999; font-size: 12px;">
                            Production-ready expense tracking with AI-powered insights
                        </p>
                    </body>
                    </html>
                `);

                printWindow.document.close();
                setTimeout(() => {
                    printWindow.print();
                }, 250);
            }

            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 16px 24px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    z-index: 1000;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                    animation: slideIn 0.3s ease-out;
                `;

                const colors = {
                    success: '#10b981',
                    error: '#ef4444',
                    warning: '#f59e0b',
                    info: '#3b82f6'
                };

                notification.style.backgroundColor = colors[type];
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-out';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
        }

        // CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: scale(0.9); }
                to { opacity: 1; transform: scale(1); }
            }
            @keyframes slideIn {
                from { transform: translateX(100%); }
                to { transform: translateX(0); }
            }
            @keyframes slideOut {
                from { transform: translateX(0); }
                to { transform: translateX(100%); }
            }
        `;
        document.head.appendChild(style);

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            new ExpenseSnapQRGenerator();
        });
    </script>
</body>
</html>
